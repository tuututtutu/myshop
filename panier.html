<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Panier ‚Äì MyShop</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{background:#020617;color:#e5e7eb;font-family:Segoe UI,system-ui}
.container{max-width:900px;margin:60px auto;padding:20px}
.item{display:flex;justify-content:space-between;align-items:center;
background:#020617;border:1px solid #1e293b;border-radius:14px;
padding:18px;margin-bottom:15px}
.left{display:flex;gap:20px;align-items:center}
img{width:70px;border-radius:10px}
.price{color:#38bdf8;font-weight:700}
.pay{padding:10px 18px;border:none;border-radius:10px;
background:#38bdf8;color:#020617;font-weight:700;cursor:pointer}
.empty{text-align:center;opacity:.7;margin-top:40px}
</style>
</head>

<body>

<div class="container">
  <h2>Votre panier</h2>
  <div id="cart"></div>
</div>

<script>
const user = JSON.parse(localStorage.getItem("user"));
if (!user || !user.email) {
  document.getElementById("cart").innerHTML =
    "<p class='empty'>Vous devez √™tre connect√©</p>";
  throw new Error("Non connect√©");
}

const cartKey = "cart_" + user.email;
const cart = JSON.parse(localStorage.getItem(cartKey)) || [];

const cartDiv = document.getElementById("cart");

/*
  üîó Payment Links Stripe LIVE
  ‚ö†Ô∏è la cl√© DOIT correspondre √† item.product
*/
const paymentLinks = {
  "tshirt1": "https://buy.stripe.com/XXXXXXXXXX",
  "maillot1": "https://buy.stripe.com/YYYYYYYYYY",
  "montre1": "https://buy.stripe.com/ZZZZZZZZZZ",
  "ensemble1": "https://buy.stripe.com/AAAAAAAAAA"
};

if (!cart.length) {
  cartDiv.innerHTML = "<p class='empty'>Panier vide üõí</p>";
}

cart.forEach(item => {
  const link = paymentLinks[item.product];

  const div = document.createElement("div");
  div.className = "item";

  div.innerHTML = `
    <div class="left">
      <img src="images/${item.product}-${item.color}.png">
      <div>
        <strong>${item.name}</strong><br>
        <small>Couleur : ${item.color}</small>
        ${item.size ? `<br><small>Taille : ${item.size}</small>` : ""}
      </div>
    </div>
    <div>
      <div class="price">${item.price.toFixed(2)} ‚Ç¨</div>
      <button class="pay">Payer</button>
    </div>
  `;

  div.querySelector(".pay").onclick = () => {
    if (!link) {
      alert("Lien de paiement indisponible");
      return;
    }
    window.location.href = link;
  };

  cartDiv.appendChild(div);
});
</script>

</body>
</html>
